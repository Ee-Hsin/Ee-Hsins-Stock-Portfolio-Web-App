<% layout('layouts/boilerplate')%>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
<ul>
    <li>Name: <%= stock.name %></li>
    <li>Ticker: <%= stock.ticker %></li>
    <li>Avg Price: <%= stock.price %></li>
    <li>Units: <%= stock.units %></li>
    <li>Current Price: <%= currentPrice %></li>
    <li>Returns: <%= returns %>%</li>
    <% if(!currentUser) {%>
    <li>IV (Intrinsic Value): *Login to view Intrinsic Value*</li>
    <% } %> 
    <% if(currentUser) {%>
    <li>IV (Intrinsic Value): <%= stock.IV %></li>
    <% } %> 
    <li>Category: <%= stock.category %></li>
    <li>Description: <%= stock.description %></li>
</ul>

<canvas id="chart" width="200" height = "200"></canvas>

<div id="stockCarousel" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
        <% stock.images.forEach((img, i) => {  %>
        <div class="carousel-item <%= i === 0 ? 'active' : ''%>">
            <img src="<%= img.url%>" class="d-block w-100" alt="">
        </div>
        <% }) %>

    </div>
    <% if(stock.images.length > 1) {%>
    <a class="carousel-control-prev" href="#stockCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#stockCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    <% } %>
</div>
<% if (currentUser && currentUser._id == adminId) { %>
<p>
    <form action="/portfolio/<%=stock._id%>?_method=DELETE" method="POST">
        <button>Delete</button>
    </form>
</p>
<div>
    <a href="/portfolio/<%= stock._id%>/edit">Edit Stock</a>
  <% } %>
    <a href="/portfolio">Back to Portfolio</a>
</div>
<script>
    const chartData = <%- JSON.stringify(candleData) %>;
</script>
<script src="/javascripts/chartingData.js"></script>


